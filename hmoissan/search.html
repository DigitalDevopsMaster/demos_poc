<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Meta tags para experiencia móvil completa -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0d5d56">
    
    <title>Hmoissan - Joyería Fina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <style>
        .search-header {
            background-color: #0d5d56;
            padding: 15px;
            color: white;
        }
        .search-bar {
            display: flex;
            align-items: center;
            background: white;
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
        }
        .search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 16px;
            margin-left: 10px;
        }
        .search-filters {
            padding: 15px;
            background: #f9f9f9;
            border-bottom: 1px solid #eee;
        }
        .filter-chips {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        .filter-chip {
            background: white;
            border: 1px solid #ddd;
            padding: 6px 12px;
            border-radius: 16px;
            white-space: nowrap;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .filter-chip.active {
            background: #0d5d56;
            color: white;
            border-color: #0d5d56;
        }
        .search-results {
            padding: 15px;
        }
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .results-count {
            color: #666;
            font-size: 14px;
        }
        .sort-btn {
            background: none;
            border: 1px solid #ddd;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        .product-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .product-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
        }
        .product-card:hover {
            transform: translateY(-2px);
        }
        .product-card img {
            width: 100%;
            height: 140px;
            object-fit: cover;
        }
        .product-info {
            padding: 12px;
        }
        .product-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 5px;
            color: #333;
        }
        .product-price {
            color: #0d5d56;
            font-weight: 700;
            font-size: 16px;
        }
        .favorite-icon {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        .no-results i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ddd;
        }
    </style>
    
    <mobile-view>
        <div>
            <!-- Search Header -->
            <div class="search-header">
                <div style="display: flex; align-items: center;">
                    <div onclick="goToNotifications()" style="position: relative; cursor: pointer;">
                        <i class="fas fa-bell" style="font-size: 20px;"></i>
                        <span id="notificationBadge" style="position: absolute; top: -8px; right: -8px; background: #ff4444; color: white; border-radius: 50%; width: 16px; height: 16px; font-size: 10px; display: flex; align-items: center; justify-content: center; font-weight: 600;">2</span>
                    </div>
                    <i class="fas fa-arrow-left" style="margin-right: 15px; cursor: pointer; font-size: 18px;" onclick="goBack()"></i>
                    <span style="font-weight: bold; font-size: 18px;">Buscar</span>
                </div>
                <div class="search-bar">
                    <i class="fas fa-search" style="color: #666;"></i>
                    <input type="text" class="search-input" placeholder="Buscar joyas, anillos, collares..." id="searchInput" oninput="performSearch()">
                    <i class="fas fa-microphone" style="color: #666; cursor: pointer; margin-left: 10px;"></i>
                </div>
            </div>
    
            <!-- Search Filters -->
            <div class="search-filters">
                <div class="filter-chips">
                    <div class="filter-chip active" onclick="setFilter('all')">Todos</div>
                    <div class="filter-chip" onclick="setFilter('rings')">Anillos</div>
                    <div class="filter-chip" onclick="setFilter('necklaces')">Collares</div>
                    <div class="filter-chip" onclick="setFilter('earrings')">Aretes</div>
                    <div class="filter-chip" onclick="setFilter('bracelets')">Pulseras</div>
                    <div class="filter-chip" onclick="setFilter('price-low')">Precio Bajo</div>
                    <div class="filter-chip" onclick="setFilter('price-high')">Precio Alto</div>
                </div>
            </div>
    
            <!-- Search Results -->
            <div class="search-results">
                <div class="results-header">
                    <span class="results-count" id="resultsCount">12 resultados encontrados</span>
                    <button class="sort-btn" onclick="toggleSort()">
                        <i class="fas fa-sort" style="margin-right: 5px;"></i>
                        Ordenar
                    </button>
                </div>
    
                <!-- Product Grid -->
                <div class="product-grid" id="productGrid">
                    <!-- Products will be populated by JavaScript -->
                </div>
    
                <!-- No Results Message -->
                <div class="no-results" id="noResults" style="display: none;">
                    <i class="fas fa-search"></i>
                    <h3>No se encontraron resultados</h3>
                    <p>Intenta con otros términos de búsqueda o explora nuestras categorías.</p>
                </div>
            </div>
        </div>
    </mobile-view>
    
    <script>
        class MobileView extends HTMLElement {
            constructor() {
                super();
                const shadow = this.attachShadow({ mode: 'open' });
    
                // Add Font Awesome CDN to shadow DOM
                const fontAwesomeLink = document.createElement('link');
                fontAwesomeLink.setAttribute('rel', 'stylesheet');
                fontAwesomeLink.setAttribute('href', 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');
                shadow.appendChild(fontAwesomeLink);
    
                // Main container
                const wrapper = document.createElement('div');
                wrapper.id = 'mobileFrameCtn';
                wrapper.innerHTML = `
                    <div id="mobileFrameEl">
                        <!-- Status Bar -->
                        <div id="statusBarEl">
                            <span>9:41</span>
                            <div style="display: flex; gap: 6px;">
                                <i class="fas fa-signal"></i>
                                <i class="fas fa-battery-three-quarters"></i>
                            </div>
                        </div>
                        
                        <!-- App Content Area -->
                        <div id="screenContentEl">
                            <slot></slot>
                        </div>
                        
                        <!-- Bottom Navigation Bar -->
                        <div id="navBarEl">
                            <div class="nav-item" onclick="goToHome()">
                                <i class="fas fa-home"></i>
                                <span>Home</span>
                            </div>
                            <div class="nav-item" onclick="goToCart()">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Carrito</span>
                            </div>
                            <div class="nav-item" onclick="goToProfile()">
                                <i class="fas fa-user"></i>
                                <span>Perfil</span>
                            </div>
                        </div>
                    </div>
                `;
    
                // Internal styles
                const style = document.createElement('style');
                style.textContent = `
                    #mobileFrameCtn {
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        min-height: 100vh;
                        background-color: #f5f5f5;
                    }
                    #mobileFrameEl {
                        width: 375px;
                        height: 667px;
                        border-radius: 36px;
                        overflow: hidden;
                        box-shadow: 0 0 0 14px #1a1a1a, 0 0 0 16px #2a2a2a, 0 20px 40px rgba(0,0,0,0.3);
                        position: relative;
                        display: flex;
                        flex-direction: column;
                    }
                    #statusBarEl {
                        height: 44px;
                        background: #000;
                        color: #fff;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 0 20px;
                        font-size: 14px;
                    }
                    #screenContentEl {
                        flex: 1;
                        overflow-y: auto;
                        background: #fff;
                        padding-bottom: 60px;
                    }
                    #navBarEl {
                        height: 60px;
                        background: #fff;
                        color: #333;
                        display: flex;
                        justify-content: space-around;
                        align-items: center;
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        right: 0;
                        border-top: 1px solid #ddd;
                        z-index: 1;
                    }
                    .nav-item {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        padding: 5px 10px;
                        cursor: pointer;
                        transition: color 0.3s;
                    }
                    .nav-item i {
                        font-size: 20px;
                        margin-bottom: 4px;
                    }
                    .nav-item span {
                        font-size: 12px;
                    }
                `;
    
                shadow.appendChild(style);
                shadow.appendChild(wrapper);
            }
        }
    
        customElements.define('mobile-view', MobileView);
    
        // Sample product data for search
        const allProducts = [
            { id: 1, name: 'Elegant Diamond Ring', price: 2450, category: 'rings', image: 'https://hmoissan.com.mx/cdn/shop/files/19.jpg?v=1702354507&width=640' },
            { id: 2, name: 'Pearl Necklace', price: 1890, category: 'necklaces', image: 'https://hmoissan.com.mx/cdn/shop/files/11.jpg?v=1702354238&width=640' },
            { id: 3, name: 'Emerald Earrings', price: 1250, category: 'earrings', image: 'https://hmoissan.com.mx/cdn/shop/files/4_2e0ed931-85fd-4655-83a3-ade437c68edc.jpg?v=1702354428&width=640' },
            { id: 4, name: 'Bracelet Émeraude', price: 120, category: 'bracelets', image: 'https://hmoissan.com.mx/cdn/shop/files/5_ba5c5a53-66c8-4bf4-9fb1-68c961ae1d93.jpg?v=1702354238&width=770' },
            { id: 5, name: 'Bague Or', price: 95, category: 'rings', image: 'https://hmoissan.com.mx/cdn/shop/files/17.jpg?v=1702354428&width=770' },
            { id: 6, name: 'Collier Diamant', price: 420, category: 'necklaces', image: 'https://hmoissan.com.mx/cdn/shop/files/6_0bb32742-7575-4704-b9eb-cd8b893c4420.jpg?v=1702354356&width=770' },
            { id: 7, name: 'Boucles Perles', price: 85, category: 'earrings', image: 'https://hmoissan.com.mx/cdn/shop/files/4_c9851639-c118-4220-8105-e1d9560c6e43.jpg?v=1702354507&width=770' },
            { id: 8, name: 'Baguette Émeraude', price: 450, category: 'engagement-rings', image: 'https://hmoissan.com.mx/cdn/shop/files/EmeraldCutEngagementRings2.jpg?v=1718135089&width=770' },
            { id: 9, name: 'Parure Émeraude', price: 1200, category: 'high-jewelry', image: 'https://hmoissan.com.mx/cdn/shop/files/Aretes-7.jpg?v=1748563878&width=770' },
            { id: 10, name: 'Bracelet Rubis', price: 150, category: 'bracelets', image: 'https://hmoissan.com.mx/cdn/shop/files/5_ba5c5a53-66c8-4bf4-9fb1-68c961ae1d93.jpg?v=1702354238&width=770' },
            { id: 11, name: 'Bague Diamant', price: 320, category: 'rings', image: 'https://hmoissan.com.mx/cdn/shop/files/17.jpg?v=1702354428&width=770' },
            { id: 12, name: 'Collier Perles', price: 200, category: 'necklaces', image: 'https://hmoissan.com.mx/cdn/shop/files/6_0bb32742-7575-4704-b9eb-cd8b893c4420.jpg?v=1702354356&width=770' }
        ];
    
        let filteredProducts = [...allProducts];
        let currentFilter = 'all';
        let sortOrder = 'relevance';
    
        // Initialize search on page load
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const query = urlParams.get('q');
            if (query) {
                document.getElementById('searchInput').value = query;
                performSearch();
            } else {
                renderProducts(allProducts);
            }
        });
    
        function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            
            if (query.trim() === '') {
                filteredProducts = [...allProducts];
            } else {
                filteredProducts = allProducts.filter(product => 
                    product.name.toLowerCase().includes(query) ||
                    product.category.toLowerCase().includes(query)
                );
            }
            
            applyFilter();
        }
    
        function setFilter(filter) {
            currentFilter = filter;
            
            // Update filter chip appearance
            document.querySelectorAll('.filter-chip').forEach(chip => chip.classList.remove('active'));
            event.target.classList.add('active');
            
            applyFilter();
        }
    
        function applyFilter() {
            let products = [...filteredProducts];
            
            // Apply category filter
            if (currentFilter !== 'all') {
                if (currentFilter === 'price-low') {
                    products = products.filter(p => p.price < 200);
                } else if (currentFilter === 'price-high') {
                    products = products.filter(p => p.price >= 500);
                } else {
                    products = products.filter(p => p.category === currentFilter);
                }
            }
            
            // Apply sorting
            if (sortOrder === 'price-low') {
                products.sort((a, b) => a.price - b.price);
            } else if (sortOrder === 'price-high') {
                products.sort((a, b) => b.price - a.price);
            }
            
            renderProducts(products);
        }
    
        function renderProducts(products) {
            const grid = document.getElementById('productGrid');
            const noResults = document.getElementById('noResults');
            const resultsCount = document.getElementById('resultsCount');
            
            resultsCount.textContent = `${products.length} resultados encontrados`;
            
            if (products.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            grid.innerHTML = products.map(product => `
                <div class="product-card" onclick="goToProduct('${product.id}')">
                    <img src="${product.image}" alt="${product.name}">
                    <div class="favorite-icon" onclick="event.stopPropagation(); toggleFavorite(${product.id})">
                        <i class="fas fa-heart" style="color: #ddd;"></i>
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">$${product.price.toLocaleString()}</div>
                    </div>
                </div>
            `).join('');
        }
    
        function toggleSort() {
            const sortOptions = ['relevance', 'price-low', 'price-high'];
            const currentIndex = sortOptions.indexOf(sortOrder);
            sortOrder = sortOptions[(currentIndex + 1) % sortOptions.length];
            
            const sortLabels = {
                'relevance': 'Relevancia',
                'price-low': 'Precio: Menor a Mayor',
                'price-high': 'Precio: Mayor a Menor'
            };
            
            document.querySelector('.sort-btn').innerHTML = `
                <i class="fas fa-sort" style="margin-right: 5px;"></i>
                ${sortLabels[sortOrder]}
            `;
            
            applyFilter();
        }
    
        function toggleFavorite(productId) {
            const icon = event.target;
            if (icon.style.color === 'rgb(255, 68, 68)') {
                icon.style.color = '#ddd';
            } else {
                icon.style.color = '#ff4444';
            }
        }
    
        function goToProduct(productId) {
            window.location.href = `./product-detail.html?id=${productId}`;
        }
    
        function goBack() {
            window.history.back();
        }
    
        function goToHome() {
            window.location.href = './index.html';
        }
    
        function goToCart() {
            window.location.href = './cart.html';
        }
    
        function goToProfile() {
            window.location.href = './profile.html';
        }
    
        function goToNotifications() {
            window.location.href = './notifications.html';
        }
    
        // Update notification badge
        window.addEventListener('DOMContentLoaded', function() {
            const unreadCount = localStorage.getItem('unreadNotifications') || '2';
            const badge = document.getElementById('notificationBadge');
            if (badge && unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'flex';
            } else if (badge) {
                badge.style.display = 'none';
            }
        });
    
        // Detect if viewing on mobile device
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
        }

        // Mobile device optimization
        window.addEventListener('DOMContentLoaded', function() {
            if (isMobileDevice()) {
                const mobileView = document.querySelector('mobile-view');
                if (mobileView && mobileView.shadowRoot) {
                    const statusBar = mobileView.shadowRoot.querySelector('#statusBarEl');
                    if (statusBar) statusBar.style.display = 'none';
                    mobileView.style.cssText = `
                        display: block;
                        width: 100vw;
                        height: 100vh;
                        margin: 0;
                        border-radius: 0;
                        box-shadow: none;
                    `;
                }
            }
        });
    </script>
   
</body>
</html>
